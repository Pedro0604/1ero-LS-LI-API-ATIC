EOI EQU 20H
IMR EQU 21H
INT2 EQU 26H
HAND EQU 40H
EST EQU 41H


ORG 40
 DW RUT_HAND


ORG 1000H
 MSJ DB "INGRESE UN CARACTER:"
 CAR DB ?, ?, ?, ?, ?


ORG 2000H
 MOV BX, OFFSET CAR
 PUSH BX
 MOV CL, 5
INGR:MOV BX, OFFSET MSJ
 MOV AL, OFFSET CAR-OFFSET MSJ
 INT 7
 POP BX
 INT 6
 INC BX
 PUSH BX
 DEC CL
 JNZ INGR
 

 MOV BX, OFFSET CAR
 MOV CL, 10
CLI
 MOV AL, 11111011B
 OUT IMR, AL
 MOV AL, 10
 OUT INT2, AL
 MOV AL, 80H
 OUT EST, AL
STI
LOOP:JMP LOOP

ORG 3000H
RUT_HAND:PUSH AX
 CMP CL, 6
 JS INV
 MOV AL, [BX]
 OUT HAND, AL
 INC BX
 DEC CL
 JMP FIN_RUT
 
INV:DEC BX
 MOV AL, [BX]
 OUT HAND, AL
 DEC CL
 JZ TERMINO

FIN_RUT:MOV AL, EOI
 OUT EOI, AL
 POP AX
 IRET

TERMINO:IN AL, EST
 AND AL, 7FH
 OUT EST, AL
 POP AX
 HLT
 END
