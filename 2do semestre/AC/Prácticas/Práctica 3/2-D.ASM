EOI EQU 20H
IMR EQU 21H
INT0 EQU 24H

PA EQU 30H
PB EQU 31H
CA EQU 32H
CB EQU 33H


ORG 40
 DW RUT_F10


ORG 1000H
 MSJ DB "INGRESE UN CARACTER:"
 CAR DB ?


ORG 2000H
 MOV AL, 0
 OUT CB, AL
 MOV AL, 11111101B
 OUT CA, AL
 IN AL, PA
 AND AL, 11111101B
 OUT PA, AL
 MOV BX, OFFSET CAR
 PUSH BX
 MOV CL, 0
CLI
 MOV AL, 11111110B
 OUT IMR, AL
 MOV AL, 10
 OUT INT0, AL
STI

LOOP:MOV BX, OFFSET MSJ
 MOV AL, OFFSET CAR-OFFSET MSJ
 INT 7
 POP BX
 INT 6
 INC CL
 INC BX
 PUSH BX
JMP LOOP


ORG 3000H
RUT_F10:MOV BX, OFFSET CAR
POLL:IN AL, PA
 AND AL, 1
 JNZ POLL

 MOV AL, [BX]
 OUT PB, AL
 
 IN AL, PA
 OR AL, 00000010B
 OUT PA, AL

 IN AL, PA
 AND AL, 11111101B
 OUT PA, AL
 
 INC BX
 DEC CL
 JNZ POLL

 HLT
 END
